<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kbtbr">
<title>Data wrangling of responses • kbtbr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data wrangling of responses">
<meta property="og:description" content="kbtbr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kbtbr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/kbtbr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/wrangling-survey-responses.html">Data wrangling of responses</a>
    <a class="dropdown-item" href="../articles/koboclient-class.html">Advanced: The KoboClient class</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CorrelAid/kbtbr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="wrangling-survey-responses_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data wrangling of responses</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CorrelAid/kbtbr/blob/HEAD/vignettes/wrangling-survey-responses.Rmd" class="external-link"><code>vignettes/wrangling-survey-responses.Rmd</code></a></small>
      <div class="d-none name"><code>wrangling-survey-responses.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article demonstrates some techniques for cleaning and wrangling data returned by the <code>get_submissions</code> method of the <code>Kobo</code> and <code>Asset</code> classes. The vignette is broken down by the different question types. In general, users should make heavy use of the question options to give <a href="https://support.kobotoolbox.org/question_options.html#data-column-name" class="external-link">custom column names</a> and labels for answer options. This will result in better behaving column names and make data cleaning easier.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CorrelAid/kbtbr/" class="external-link">kbtbr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">BASE_URL</span> <span class="op">&lt;-</span> <span class="st">"https://kobo.correlaid.org"</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kobo</span> <span class="op">&lt;-</span>
  <span class="va"><a href="../reference/Kobo.html">Kobo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>base_url_v2 <span class="op">=</span> <span class="va">BASE_URL</span>,
           kobo_token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"KBTBR_TOKEN"</span><span class="op">)</span><span class="op">)</span>
<span class="va">asset_id</span> <span class="op">&lt;-</span> <span class="st">"aRo4wg5utWT7dwdnQQEAE7"</span>
<span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">get_submissions</span><span class="op">(</span><span class="va">asset_id</span><span class="op">)</span></code></pre></div>
<p>Let’s look at the column names:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">submissions_df</span><span class="op">)</span>
<span class="co">#&gt;  [1] "_id"                                               </span>
<span class="co">#&gt;  [2] "control_over_life"                                 </span>
<span class="co">#&gt;  [3] "Taking_all_things_to_ould_you_say_you_are"         </span>
<span class="co">#&gt;  [4] "voluntary_activity"                                </span>
<span class="co">#&gt;  [5] "trust_in_groups/Your_family"                       </span>
<span class="co">#&gt;  [6] "formhub/uuid"                                      </span>
<span class="co">#&gt;  [7] "_validation_status"                                </span>
<span class="co">#&gt;  [8] "importance_in_life/Politics"                       </span>
<span class="co">#&gt;  [9] "_uuid"                                             </span>
<span class="co">#&gt; [10] "health_self_assessment"                            </span>
<span class="co">#&gt; [11] "importance_in_life/Friends_and_acquaintances"      </span>
<span class="co">#&gt; [12] "_tags"                                             </span>
<span class="co">#&gt; [13] "trust_in_groups/People_you_know_personally"        </span>
<span class="co">#&gt; [14] "_submitted_by"                                     </span>
<span class="co">#&gt; [15] "_xform_id_string"                                  </span>
<span class="co">#&gt; [16] "importance_in_life/Family"                         </span>
<span class="co">#&gt; [17] "trust_in_groups/People_you_meet_for_the_first_time"</span>
<span class="co">#&gt; [18] "meta/instanceID"                                   </span>
<span class="co">#&gt; [19] "trust_in_groups/People_of_another_nationality"     </span>
<span class="co">#&gt; [20] "trust_in_groups/People_in_your_neighborhood"       </span>
<span class="co">#&gt; [21] "importance_in_life/Religion"                       </span>
<span class="co">#&gt; [22] "end"                                               </span>
<span class="co">#&gt; [23] "locate_hamburg"                                    </span>
<span class="co">#&gt; [24] "_submission_time"                                  </span>
<span class="co">#&gt; [25] "_notes"                                            </span>
<span class="co">#&gt; [26] "_attachments"                                      </span>
<span class="co">#&gt; [27] "importance_in_life/Leisure_time"                   </span>
<span class="co">#&gt; [28] "start"                                             </span>
<span class="co">#&gt; [29] "trust_in_groups/People_of_another_religion"        </span>
<span class="co">#&gt; [30] "_geolocation"                                      </span>
<span class="co">#&gt; [31] "importance_in_life/Work"                           </span>
<span class="co">#&gt; [32] "_status"                                           </span>
<span class="co">#&gt; [33] "__version__"                                       </span>
<span class="co">#&gt; [34] "trust_in_others"                                   </span>
<span class="co">#&gt; [35] "file_upload"</span></code></pre></div>
<p>The form contains questions of several of the available types in KoBoToolbox. The whole list of available types can be found <a href="https://support.kobotoolbox.org/question_types.html" class="external-link">here</a>. More information also on the <a href="https://xlsform.org/en/" class="external-link">xlsform</a> page.</p>
<p>Our test form includes:</p>
<ul>
<li>select one: <code>Taking_all_things_to_ould_you_say_you_are</code> (an example for a bad question label!), <code>health_self_assessment</code>, <code>voluntary_activity</code>, <code>trust_in_others</code>
</li>
<li>
<a href="https://support.kobotoolbox.org/rating_ranking.html#how-to-add-a-rating-question" class="external-link">rating</a>: <code>trust_in_groups/{category}</code>, <code>trust_in_groups/{importance_in_life}</code>
</li>
<li>range: <code>control_over_life</code>
</li>
<li>point (location): <code>locate_hamburg</code>
</li>
<li>file upload: <code>file_upload</code>
</li>
</ul>
<p>The rest of the columns are metadata automatically added by KoboToolbox. Most of them start with <code>_</code>.</p>
</div>
<div class="section level2">
<h2 id="column-names">Column names<a class="anchor" aria-label="anchor" href="#column-names"></a>
</h2>
<div class="section level3">
<h3 id="sorting">Sorting<a class="anchor" aria-label="anchor" href="#sorting"></a>
</h3>
<p>As could be seen above, the API does not provide a meaningful sorting of the columns.</p>
<p>Some initial reordering to at least put the metadata columns to the front:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"_"</span><span class="op">)</span>, <span class="va">start</span>, <span class="va">end</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">submissions_df</span><span class="op">)</span>
<span class="co">#&gt;  [1] "_id"                                               </span>
<span class="co">#&gt;  [2] "_validation_status"                                </span>
<span class="co">#&gt;  [3] "_uuid"                                             </span>
<span class="co">#&gt;  [4] "_tags"                                             </span>
<span class="co">#&gt;  [5] "_submitted_by"                                     </span>
<span class="co">#&gt;  [6] "_xform_id_string"                                  </span>
<span class="co">#&gt;  [7] "_submission_time"                                  </span>
<span class="co">#&gt;  [8] "_notes"                                            </span>
<span class="co">#&gt;  [9] "_attachments"                                      </span>
<span class="co">#&gt; [10] "_geolocation"                                      </span>
<span class="co">#&gt; [11] "_status"                                           </span>
<span class="co">#&gt; [12] "__version__"                                       </span>
<span class="co">#&gt; [13] "start"                                             </span>
<span class="co">#&gt; [14] "end"                                               </span>
<span class="co">#&gt; [15] "control_over_life"                                 </span>
<span class="co">#&gt; [16] "Taking_all_things_to_ould_you_say_you_are"         </span>
<span class="co">#&gt; [17] "voluntary_activity"                                </span>
<span class="co">#&gt; [18] "trust_in_groups/Your_family"                       </span>
<span class="co">#&gt; [19] "formhub/uuid"                                      </span>
<span class="co">#&gt; [20] "importance_in_life/Politics"                       </span>
<span class="co">#&gt; [21] "health_self_assessment"                            </span>
<span class="co">#&gt; [22] "importance_in_life/Friends_and_acquaintances"      </span>
<span class="co">#&gt; [23] "trust_in_groups/People_you_know_personally"        </span>
<span class="co">#&gt; [24] "importance_in_life/Family"                         </span>
<span class="co">#&gt; [25] "trust_in_groups/People_you_meet_for_the_first_time"</span>
<span class="co">#&gt; [26] "meta/instanceID"                                   </span>
<span class="co">#&gt; [27] "trust_in_groups/People_of_another_nationality"     </span>
<span class="co">#&gt; [28] "trust_in_groups/People_in_your_neighborhood"       </span>
<span class="co">#&gt; [29] "importance_in_life/Religion"                       </span>
<span class="co">#&gt; [30] "locate_hamburg"                                    </span>
<span class="co">#&gt; [31] "importance_in_life/Leisure_time"                   </span>
<span class="co">#&gt; [32] "trust_in_groups/People_of_another_religion"        </span>
<span class="co">#&gt; [33] "importance_in_life/Work"                           </span>
<span class="co">#&gt; [34] "trust_in_others"                                   </span>
<span class="co">#&gt; [35] "file_upload"</span></code></pre></div>
<p>For very large forms, it might be useful to investigate on how to sort the columns alphabetically or by the order they appeared in the form. With the small form here, we can still individually select the columns to put them into a meaningful order:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"_"</span><span class="op">)</span>,
    <span class="va">start</span>,
    <span class="va">end</span>,
    <span class="va">Taking_all_things_to_ould_you_say_you_are</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"importance_in_life"</span><span class="op">)</span>,
    <span class="va">trust_in_others</span>,
    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"trust_in_groups"</span><span class="op">)</span>,
    <span class="va">control_over_life</span>,
    <span class="va">voluntary_activity</span>,
    <span class="va">locate_hamburg</span>,
    <span class="va">health_self_assessment</span>,
    <span class="va">file_upload</span>
  <span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cleaning-column-names">Cleaning column names<a class="anchor" aria-label="anchor" href="#cleaning-column-names"></a>
</h3>
<p>Fortunately, the KoBoToolbox API already has quite sensible column names, with snakecase (i.e. "_" separator) being the default. Column names are determined by the <em>question name</em> and thus are configurable via <a href="https://xlsform.org/en/#the-survey-worksheet" class="external-link">xlsform</a> or the KoboToolbox interface (question settings -&gt; “Data column name”).</p>
<p>Typically, it is a good idea to immediately clean column names with a function like <code><a href="https://rdrr.io/pkg/janitor/man/clean_names.html" class="external-link">janitor::clean_names</a></code>. However, this might be disadvantageous when wrangling rating type questions because question name and category name are conveniently separated by a “/” for those questions.</p>
<p>Hence, we can only clean the meta data column names, removing the "_" at the beginning:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span>
<span class="va">renamed_meta</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="va">make_clean_names</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Alternatively, we can exclude the rating questions and clean all the other names:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span>
<span class="va">renamed_except_rating</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span><span class="va">make_clean_names</span>,<span class="op">-</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"importance_in_life"</span>, <span class="st">"trust_in_groups"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">renamed_except_rating</span><span class="op">)</span>
<span class="co">#&gt;  [1] "id"                                                </span>
<span class="co">#&gt;  [2] "validation_status"                                 </span>
<span class="co">#&gt;  [3] "uuid"                                              </span>
<span class="co">#&gt;  [4] "tags"                                              </span>
<span class="co">#&gt;  [5] "submitted_by"                                      </span>
<span class="co">#&gt;  [6] "xform_id_string"                                   </span>
<span class="co">#&gt;  [7] "submission_time"                                   </span>
<span class="co">#&gt;  [8] "notes"                                             </span>
<span class="co">#&gt;  [9] "attachments"                                       </span>
<span class="co">#&gt; [10] "geolocation"                                       </span>
<span class="co">#&gt; [11] "status"                                            </span>
<span class="co">#&gt; [12] "version"                                           </span>
<span class="co">#&gt; [13] "start"                                             </span>
<span class="co">#&gt; [14] "end"                                               </span>
<span class="co">#&gt; [15] "taking_all_things_to_ould_you_say_you_are"         </span>
<span class="co">#&gt; [16] "importance_in_life/Politics"                       </span>
<span class="co">#&gt; [17] "importance_in_life/Friends_and_acquaintances"      </span>
<span class="co">#&gt; [18] "importance_in_life/Family"                         </span>
<span class="co">#&gt; [19] "importance_in_life/Religion"                       </span>
<span class="co">#&gt; [20] "importance_in_life/Leisure_time"                   </span>
<span class="co">#&gt; [21] "importance_in_life/Work"                           </span>
<span class="co">#&gt; [22] "trust_in_others"                                   </span>
<span class="co">#&gt; [23] "trust_in_groups/Your_family"                       </span>
<span class="co">#&gt; [24] "trust_in_groups/People_you_know_personally"        </span>
<span class="co">#&gt; [25] "trust_in_groups/People_you_meet_for_the_first_time"</span>
<span class="co">#&gt; [26] "trust_in_groups/People_of_another_nationality"     </span>
<span class="co">#&gt; [27] "trust_in_groups/People_in_your_neighborhood"       </span>
<span class="co">#&gt; [28] "trust_in_groups/People_of_another_religion"        </span>
<span class="co">#&gt; [29] "control_over_life"                                 </span>
<span class="co">#&gt; [30] "voluntary_activity"                                </span>
<span class="co">#&gt; [31] "locate_hamburg"                                    </span>
<span class="co">#&gt; [32] "health_self_assessment"                            </span>
<span class="co">#&gt; [33] "file_upload"</span></code></pre></div>
<p>For the purposes of the rest of this article, we choose the second version:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">renamed_except_rating</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="data-cleaning">Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h2>
<div class="section level3">
<h3 id="type-conversion">Type conversion<a class="anchor" aria-label="anchor" href="#type-conversion"></a>
</h3>
<p>In general, the KoBoToolbox API will return all data as character vectors. Hence, conversion is necessary where applicable.</p>
<p>To convert multiple columns at once, you can use <code><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">dplyr::across</a></code> in combination with the <a href="https://tidyselect.r-lib.org/reference/select_helpers.html" class="external-link">tidyselect helpers</a>:</p>
<p>To check which columns need converting:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">submissions_df</span><span class="op">)</span>
<span class="co">#&gt; Rows: 8</span>
<span class="co">#&gt; Columns: 33</span>
<span class="co">#&gt; $ id                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 482, 484, 485, 48…</span>
<span class="co">#&gt; $ validation_status                                    <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> &lt;NULL&gt;, &lt;N…</span>
<span class="co">#&gt; $ uuid                                                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "199a3066-72a2-48…</span>
<span class="co">#&gt; $ tags                                                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [], [], [], [], …</span>
<span class="co">#&gt; $ submitted_by                                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> NA, NA, NA, NA, N…</span>
<span class="co">#&gt; $ xform_id_string                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "aRo4wg5utWT7dwdn…</span>
<span class="co">#&gt; $ submission_time                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T19:38…</span>
<span class="co">#&gt; $ notes                                                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [], [], [], [], …</span>
<span class="co">#&gt; $ attachments                                          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [&lt;data.frame[0 x…</span>
<span class="co">#&gt; $ geolocation                                          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;60.92474, -90.6…</span>
<span class="co">#&gt; $ status                                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "submitted_via_we…</span>
<span class="co">#&gt; $ version                                              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "vkhZEtuEwyhNgJro…</span>
<span class="co">#&gt; $ start                                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T21:36…</span>
<span class="co">#&gt; $ end                                                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T21:38…</span>
<span class="co">#&gt; $ taking_all_things_to_ould_you_say_you_are            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "3", "8", "3…</span>
<span class="co">#&gt; $ `importance_in_life/Politics`                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "3", "2", "3…</span>
<span class="co">#&gt; $ `importance_in_life/Friends_and_acquaintances`       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "2", "3…</span>
<span class="co">#&gt; $ `importance_in_life/Family`                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "3", "1", "2…</span>
<span class="co">#&gt; $ `importance_in_life/Religion`                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "3", "3", "2…</span>
<span class="co">#&gt; $ `importance_in_life/Leisure_time`                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "2", "3…</span>
<span class="co">#&gt; $ `importance_in_life/Work`                            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "1", "2…</span>
<span class="co">#&gt; $ trust_in_others                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "2", "2", "2…</span>
<span class="co">#&gt; $ `trust_in_groups/Your_family`                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "2", "1", "2…</span>
<span class="co">#&gt; $ `trust_in_groups/People_you_know_personally`         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "2", "2", "3…</span>
<span class="co">#&gt; $ `trust_in_groups/People_you_meet_for_the_first_time` <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "3", "2", "2", "3…</span>
<span class="co">#&gt; $ `trust_in_groups/People_of_another_nationality`      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "3", "3", "2…</span>
<span class="co">#&gt; $ `trust_in_groups/People_in_your_neighborhood`        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "3", "1", "2", "2…</span>
<span class="co">#&gt; $ `trust_in_groups/People_of_another_religion`         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2", "3", "3", NA…</span>
<span class="co">#&gt; $ control_over_life                                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "7", "3", "3", "3…</span>
<span class="co">#&gt; $ voluntary_activity                                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "8", "8", "8", "2…</span>
<span class="co">#&gt; $ locate_hamburg                                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "60.924739 -90.68…</span>
<span class="co">#&gt; $ health_self_assessment                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "5", "3", "3", "5…</span>
<span class="co">#&gt; $ file_upload                                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, "…</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"importance_in_life"</span>, <span class="st">"trust_in_groups"</span><span class="op">)</span>
  <span class="op">)</span>,
  <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
      <span class="st">"voluntary_activity"</span>,
      <span class="st">"control_over_life"</span>,
      <span class="st">"health_self_assessment"</span>,
      <span class="st">"trust_in_others"</span>,
      <span class="st">"Taking_all_things_to_ould_you_say_you_are"</span>
    <span class="op">)</span>
  <span class="op">)</span><span class="op">)</span>, <span class="va">as.integer</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">submissions_df</span><span class="op">)</span>
<span class="co">#&gt; Rows: 8</span>
<span class="co">#&gt; Columns: 33</span>
<span class="co">#&gt; $ id                                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 482, 484, 485, 48…</span>
<span class="co">#&gt; $ validation_status                                    <span style="color: #949494; font-style: italic;">&lt;named list&gt;</span> &lt;NULL&gt;, &lt;N…</span>
<span class="co">#&gt; $ uuid                                                 <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "199a3066-72a2-48…</span>
<span class="co">#&gt; $ tags                                                 <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [], [], [], [], …</span>
<span class="co">#&gt; $ submitted_by                                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> NA, NA, NA, NA, N…</span>
<span class="co">#&gt; $ xform_id_string                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "aRo4wg5utWT7dwdn…</span>
<span class="co">#&gt; $ submission_time                                      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T19:38…</span>
<span class="co">#&gt; $ notes                                                <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [], [], [], [], …</span>
<span class="co">#&gt; $ attachments                                          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> [&lt;data.frame[0 x…</span>
<span class="co">#&gt; $ geolocation                                          <span style="color: #949494; font-style: italic;">&lt;list&gt;</span> &lt;60.92474, -90.6…</span>
<span class="co">#&gt; $ status                                               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "submitted_via_we…</span>
<span class="co">#&gt; $ version                                              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "vkhZEtuEwyhNgJro…</span>
<span class="co">#&gt; $ start                                                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T21:36…</span>
<span class="co">#&gt; $ end                                                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "2021-09-01T21:38…</span>
<span class="co">#&gt; $ taking_all_things_to_ould_you_say_you_are            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1", "3", "8", "3…</span>
<span class="co">#&gt; $ `importance_in_life/Politics`                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 3, 2, 3, 3, 3,…</span>
<span class="co">#&gt; $ `importance_in_life/Friends_and_acquaintances`       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 2, 3, 2, 1,…</span>
<span class="co">#&gt; $ `importance_in_life/Family`                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 3, 1, 2, 3, 2,…</span>
<span class="co">#&gt; $ `importance_in_life/Religion`                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 3, 3, 2, 3, 3,…</span>
<span class="co">#&gt; $ `importance_in_life/Leisure_time`                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 2, 3, 3, 2,…</span>
<span class="co">#&gt; $ `importance_in_life/Work`                            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 1, 2, 1, 1,…</span>
<span class="co">#&gt; $ trust_in_others                                      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 2, 2, 2, 1, 1,…</span>
<span class="co">#&gt; $ `trust_in_groups/Your_family`                        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 1, 2, 2, 3,…</span>
<span class="co">#&gt; $ `trust_in_groups/People_you_know_personally`         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 2, 2, 3, 2, 2,…</span>
<span class="co">#&gt; $ `trust_in_groups/People_you_meet_for_the_first_time` <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 3, 2, 2, 3, 2, 3,…</span>
<span class="co">#&gt; $ `trust_in_groups/People_of_another_nationality`      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 3, 3, 2, 1, 3,…</span>
<span class="co">#&gt; $ `trust_in_groups/People_in_your_neighborhood`        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 3, 1, 2, 2, 2, 2,…</span>
<span class="co">#&gt; $ `trust_in_groups/People_of_another_religion`         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 3, 3, NA, 2, 3…</span>
<span class="co">#&gt; $ control_over_life                                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 7, 3, 3, 3, 3, 5,…</span>
<span class="co">#&gt; $ voluntary_activity                                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8, 8, 8, 2, 8, 8,…</span>
<span class="co">#&gt; $ locate_hamburg                                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "60.924739 -90.68…</span>
<span class="co">#&gt; $ health_self_assessment                               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 5, 3, 3, 5, 5, 2,…</span>
<span class="co">#&gt; $ file_upload                                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> NA, NA, NA, NA, "…</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="locationpoint-type">Location/Point type<a class="anchor" aria-label="anchor" href="#locationpoint-type"></a>
</h3>
<p>For the geographic point question type where respondents can pick a location on a map, the response is returned as a character vector which contains the following elements separated by whitespace:</p>
<ul>
<li>latitude</li>
<li>longitude</li>
<li>altitude</li>
<li>accuracy</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">submissions_df</span><span class="op">$</span><span class="va">locate_hamburg</span><span class="op">)</span>
<span class="co">#&gt; [1] "60.924739 -90.682977 0 0"    "34.461879 -126.200905 0 0"  </span>
<span class="co">#&gt; [3] "48.52047 70.320327 0 0"      "64.520727 52.758186 0 0"    </span>
<span class="co">#&gt; [5] "62.289722 42.957603 0 0"     "53.540416 10.037051 0.8 0.1"</span></code></pre></div>
<p>To seperate them into their individual components, you can use <code>tidyr::seperate</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define the new column names</span>
<span class="va">new_column_names</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"locate_hamburg"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lat"</span>, <span class="st">"lon"</span>, <span class="st">"altitude"</span>, <span class="st">"accuracy"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>

<span class="co"># use separate to split the column into four columns</span>
<span class="va">submissions_df</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">locate_hamburg</span>, <span class="va">new_column_names</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"locate_hamburg"</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="co"># convert to double</span>
<span class="co"># inspect the result</span>
<span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"locate_hamburg"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 4</span></span>
<span class="co">#&gt;   locate_hamburg_lat locate_hamburg_lon locate_hamburg_altitude locate_hamburg_…</span>
<span class="co">#&gt;                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>              60.9               -<span style="color: #BB0000;">90.7</span>                     0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>              34.5              -<span style="color: #BB0000;">126.</span>                      0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>              48.5                70.3                     0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>              64.5                52.8                     0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>              62.3                43.0                     0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>              53.5                10.0                     0.8              0.1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>              -<span style="color: #BB0000;">6.50</span>               85.0                     0                0  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span>              53.1                11.1                     0                0</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rating-questions">Rating questions<a class="anchor" aria-label="anchor" href="#rating-questions"></a>
</h3>
<p>For rating questions - the question type corresponding to Likert scale type question matrices - one column is returned for each “subquestion”. For example:</p>
<p><img src="assets/rating_question.png"></p>
<p>will be returned as six columns starting with the question label for the whole question, in this case <code>importance_in_life</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"importance_in_life"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 6</span></span>
<span class="co">#&gt;   `importance_in_life/Polit…` `importance_in…` `importance_in…` `importance_in…`</span>
<span class="co">#&gt;                         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>                           1                1                2                1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>                           3                2                3                3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>                           2                2                1                3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>                           3                3                2                2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>                           3                2                3                3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>                           3                1                2                3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">7</span>                          <span style="color: #BB0000;">NA</span>                1               <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">8</span>                           1                2                2                3</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 2 more variables: `importance_in_life/Leisure_time` &lt;int&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   `importance_in_life/Work` &lt;int&gt;</span></span></code></pre></div>
<p>The overall question label and the label for each “subquestion” are divided by a ‘/’. This is an important detail for data cleaning because it allows us to use functions like <code><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">tidyr::pivot_longer</a></code> to bring the data into a long format (e.g. useful for plotting):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">imp_life_long</span> <span class="op">&lt;-</span> <span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"importance_in_life"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">category</span>, <span class="st">"importance_in_life/"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span>
<span class="va">imp_life_long</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 3</span></span>
<span class="co">#&gt;       id category                  level</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   482 Politics                      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   482 Friends and acquaintances     1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   482 Family                        2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   482 Religion                      1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   482 Leisure time                  1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   482 Work                          1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   484 Politics                      3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   484 Friends and acquaintances     2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   484 Family                        3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   484 Religion                      3</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="va">imp_life_long</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">category</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>mean_level <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">level</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span>, y <span class="op">=</span> <span class="va">mean_level</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Mean importance in life by category"</span>, y <span class="op">=</span> <span class="st">"mean importance"</span>, x <span class="op">=</span> <span class="st">"category"</span><span class="op">)</span></code></pre></div>
<p><img src="wrangling-survey-responses_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p>You can wrap this approach in a function:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pivot_longer_rating</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">question_name</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="va">question_name</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"level"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>category <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">category</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">question_name</span>, <span class="st">"/"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace_all</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">submissions_df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu">pivot_longer_rating</span><span class="op">(</span><span class="st">"trust_in_groups"</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 48 × 3</span></span>
<span class="co">#&gt;       id category                           level</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   482 Your family                            1</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   482 People you know personally             2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   482 People you meet for the first time     3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   482 People of another nationality          2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   482 People in your neighborhood            3</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   482 People of another religion             2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   484 Your family                            2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   484 People you know personally             2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   484 People you meet for the first time     2</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   484 People of another nationality          3</span>
<span class="co">#&gt; <span style="color: #949494;"># … with 38 more rows</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dimitri Marinelli, Lada Rudnitckaia, Malte Kyhos, Timm Hamm, Frie Preu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
