<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="kbtbr">
<title>Get started • kbtbr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="kbtbr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">kbtbr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/kbtbr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/wrangling-survey-responses.html">Data wrangling of responses</a>
    <a class="dropdown-item" href="../articles/koboclient-class.html">Advanced: The KoboClient class</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CorrelAid/kbtbr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="kbtbr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CorrelAid/kbtbr/blob/HEAD/vignettes/kbtbr.Rmd" class="external-link"><code>vignettes/kbtbr.Rmd</code></a></small>
      <div class="d-none name"><code>kbtbr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>kbtbr is a wrapper for the <a href="https://support.kobotoolbox.org/api.html" class="external-link">KoBoToolbox APIs</a>. It focuses on API v2 but also makes use of v1 if required.</p>
<p>kbtbr uses <a href="https://r6.r-lib.org/articles/Introduction.html" class="external-link">R6</a> classes. This means it has an object-oriented user interface which might feel unfamiliar to R users at first. But don’t worry - you should get used to it quickly!</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="authentication">Authentication<a class="anchor" aria-label="anchor" href="#authentication"></a>
</h3>
<p>Get an API token using any of the methods described in the <a href="https://support.kobotoolbox.org/api.html#getting-your-api-token" class="external-link">KoBoToolbox documentation</a>. Then store it as an environment variable by opening and editing your <code>.Renviron</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html" class="external-link">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Add your token on a new line as follows:</p>
<pre><code><span class="va">KBTBR_TOKEN</span><span class="op">=</span><span class="va">yourapitokenhere</span></code></pre>
<p>Save the file and restart R/RStudio.</p>
<p>Of course, you can also use local environment files or any other method to securely store the API token.</p>
</div>
<div class="section level3">
<h3 id="base-url">Base URL<a class="anchor" aria-label="anchor" href="#base-url"></a>
</h3>
<p>In order to use kbtbr, you need to know the <em>base URLs</em> of your KoBoToolbox server (cf. <a href="https://support.kobotoolbox.org/api.html#using-the-api" class="external-link">here</a>). There are two <em>base URLs</em>, one for API version 2 and one for version 1. To use the kbtbr package, you only need to specify the <em>base URL</em> for version 2. However, certain functionalities that rely on the version 1 API will require its <em>base URL</em>.</p>
<p>If you are using one of the <a href="https://support.kobotoolbox.org/server.html" class="external-link">two hosted instances</a>, those are the base URLs:</p>
<table class="table">
<thead><tr class="header">
<th align="left">version</th>
<th align="left">Humanitarian Server (OCHA)</th>
<th align="left">Non-Humanitarian Server</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">v2</td>
<td align="left"><a href="https://kobo.humanitarianresponse.info" class="external-link uri">https://kobo.humanitarianresponse.info</a></td>
<td align="left"><a href="https://kf.kobotoolbox.org" class="external-link uri">https://kf.kobotoolbox.org</a></td>
</tr>
<tr class="even">
<td align="left">v1</td>
<td align="left"><a href="https://kc.humanitarianresponse.info" class="external-link uri">https://kc.humanitarianresponse.info</a></td>
<td align="left"><a href="https://kc.kobotoolbox.org" class="external-link uri">https://kc.kobotoolbox.org</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="creating-the-kobo-instance">Creating the Kobo instance<a class="anchor" aria-label="anchor" href="#creating-the-kobo-instance"></a>
</h3>
<p>With the right base URL(s), we can create an instance of the <code>Kobo</code> class. The <code>base_url_v1</code> argument is optional.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CorrelAid/kbtbr/" class="external-link">kbtbr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">base_url_v2</span> <span class="op">&lt;-</span> <span class="st">"https://kobo.correlaid.org"</span> <span class="co"># replace with your base URL for v2</span>
<span class="va">base_url_v1</span>  <span class="op">&lt;-</span> <span class="st">"https://kc.correlaid.org"</span> <span class="co"># replace with your base URL for v1 </span>
<span class="va">token</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"KBTBR_TOKEN"</span><span class="op">)</span>

<span class="va">kobo</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Kobo.html">Kobo</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">base_url_v2</span>, <span class="va">base_url_v1</span>, <span class="va">token</span><span class="op">)</span>
<span class="va">kobo</span></code></pre></div>
<pre><code><span class="co">## &lt;Kobo&gt;</span>
<span class="co">##   Public:</span>
<span class="co">##     clone: function (deep = FALSE) </span>
<span class="co">##     clone_asset: function (clone_from, new_name, asset_type) </span>
<span class="co">##     create_asset: function (name, asset_type, description = "", sector = list(label = "", </span>
<span class="co">##     deploy_asset: function (uid) </span>
<span class="co">##     get: function (path, query = list(), version = "v2", format = "json", </span>
<span class="co">##     get_asset: function (id) </span>
<span class="co">##     get_assets: function () </span>
<span class="co">##     get_submissions: function (id) </span>
<span class="co">##     get_surveys: function (show_all_cols = FALSE) </span>
<span class="co">##     import_xls_form: function (name, file_path) </span>
<span class="co">##     initialize: function (base_url_v2 = NULL, base_url_v1 = NULL, kobo_token = Sys.getenv("KBTBR_TOKEN"), </span>
<span class="co">##     post: function (path, body, version = "v2") </span>
<span class="co">##     session_v1: KoboClient, HttpClient, R6</span>
<span class="co">##     session_v2: KoboClient, HttpClient, R6</span></code></pre>
<p>For alternative ways of initializing the <code>Kobo</code> class, see <a href="/articles/koboclient-class.html#the-use-of-koboclient-in-the-kobo-interface">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="working-with-the-kobo-class">Working with the Kobo class<a class="anchor" aria-label="anchor" href="#working-with-the-kobo-class"></a>
</h2>
<p>A good first step is to get an overview over all your assets. Almost everything in KoBoToolbox is an asset: questions, blocks, forms, templates.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">assets</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">get_assets</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">assets</span><span class="op">$</span><span class="va">asset_type</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##    block question   survey template </span>
<span class="co">##        9        4       45        7</span></code></pre>
<p>You can also just get your forms/surveys:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">get_surveys</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Inspect the data manually:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## <span style="color: #949494;"># A tibble: 6 × 9</span></span>
<span class="co">##   name    uid   date_created date_modified owner__username parent has_deployment</span>
<span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         </span>
<span class="co">## <span style="color: #BCBCBC;">1</span> Test s… a27V… 2022-01-24T… 2022-01-24T1… api_user        <span style="color: #BB0000;">NA</span>     TRUE          </span>
<span class="co">## <span style="color: #BCBCBC;">2</span> Test s… aCZ7… 2022-01-24T… 2022-01-24T1… api_user        <span style="color: #BB0000;">NA</span>     TRUE          </span>
<span class="co">## <span style="color: #BCBCBC;">3</span> Test s… aXDf… 2022-01-24T… 2022-01-24T1… api_user        <span style="color: #BB0000;">NA</span>     FALSE         </span>
<span class="co">## <span style="color: #BCBCBC;">4</span> Test s… apwD… 2022-01-24T… 2022-01-24T1… api_user        <span style="color: #BB0000;">NA</span>     FALSE         </span>
<span class="co">## <span style="color: #BCBCBC;">5</span> clonin… aXLR… 2022-01-24T… 2022-01-24T1… api_user        <span style="color: #BB0000;">NA</span>     FALSE         </span>
<span class="co">## <span style="color: #BCBCBC;">6</span> kbtbr … aRo4… 2021-05-02T… 2021-09-24T1… api_user        <span style="color: #BB0000;">NA</span>     TRUE          </span>
<span class="co">## <span style="color: #949494;"># … with 2 more variables: deployment__active &lt;lgl&gt;,</span></span>
<span class="co">## <span style="color: #949494;">#   deployment__submission_count &lt;int&gt;</span></span></code></pre>
<p>You can then extract the ID of a single survey by filtering for its name.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_id</span> <span class="op">&lt;-</span> <span class="va">surveys</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op">==</span> <span class="st">"kbtbr Testing Survey"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">uid</span><span class="op">)</span></code></pre></div>
<p>Get the answers (or <em>submissions</em> in KoBoToolbox API lingo) to the form/survey:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">submissions</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">get_submissions</span><span class="op">(</span><span class="va">test_id</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">submissions</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## tibble [8 × 35] (S3: tbl_df/tbl/data.frame)</span>
<span class="co">##  $ _id                                               : int [1:8] 482 484 485 486 487 532 647 659</span>
<span class="co">##  $ control_over_life                                 : chr [1:8] "7" "3" "3" "3" ...</span>
<span class="co">##  $ Taking_all_things_to_ould_you_say_you_are         : chr [1:8] "1" "3" "8" "3" ...</span>
<span class="co">##  $ voluntary_activity                                : chr [1:8] "8" "8" "8" "2" ...</span>
<span class="co">##  $ trust_in_groups/Your_family                       : chr [1:8] "1" "2" "1" "2" ...</span>
<span class="co">##  $ formhub/uuid                                      : chr [1:8] "1f37921296654b91b8cc11e152956764" "1f37921296654b91b8cc11e152956764" "1f37921296654b91b8cc11e152956764" "1f37921296654b91b8cc11e152956764" ...</span>
<span class="co">##  $ _validation_status                                :'data.frame':  8 obs. of  0 variables</span>
<span class="co">##  $ importance_in_life/Politics                       : chr [1:8] "1" "3" "2" "3" ...</span>
<span class="co">##  $ _uuid                                             : chr [1:8] "199a3066-72a2-48b0-ade1-c186ae6cb0e7" "199a3066-72a2-48b0-ade1-c186ae6cb0e7" "199a3066-72a2-48b0-ade1-c186ae6cb0e7" "199a3066-72a2-48b0-ade1-c186ae6cb0e7" ...</span>
<span class="co">##  $ health_self_assessment                            : chr [1:8] "5" "3" "3" "5" ...</span>
<span class="co">##  $ importance_in_life/Friends_and_acquaintances      : chr [1:8] "1" "2" "2" "3" ...</span>
<span class="co">##  $ _tags                                             :List of 8</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##  $ trust_in_groups/People_you_know_personally        : chr [1:8] "2" "2" "2" "3" ...</span>
<span class="co">##  $ _submitted_by                                     : logi [1:8] NA NA NA NA NA NA ...</span>
<span class="co">##  $ _xform_id_string                                  : chr [1:8] "aRo4wg5utWT7dwdnQQEAE7" "aRo4wg5utWT7dwdnQQEAE7" "aRo4wg5utWT7dwdnQQEAE7" "aRo4wg5utWT7dwdnQQEAE7" ...</span>
<span class="co">##  $ importance_in_life/Family                         : chr [1:8] "2" "3" "1" "2" ...</span>
<span class="co">##  $ trust_in_groups/People_you_meet_for_the_first_time: chr [1:8] "3" "2" "2" "3" ...</span>
<span class="co">##  $ meta/instanceID                                   : chr [1:8] "uuid:199a3066-72a2-48b0-ade1-c186ae6cb0e7" "uuid:199a3066-72a2-48b0-ade1-c186ae6cb0e7" "uuid:199a3066-72a2-48b0-ade1-c186ae6cb0e7" "uuid:199a3066-72a2-48b0-ade1-c186ae6cb0e7" ...</span>
<span class="co">##  $ trust_in_groups/People_of_another_nationality     : chr [1:8] "2" "3" "3" "2" ...</span>
<span class="co">##  $ trust_in_groups/People_in_your_neighborhood       : chr [1:8] "3" "1" "2" "2" ...</span>
<span class="co">##  $ importance_in_life/Religion                       : chr [1:8] "1" "3" "3" "2" ...</span>
<span class="co">##  $ end                                               : chr [1:8] "2021-09-01T21:38:34.035+02:00" "2021-09-01T21:52:25.333+02:00" "2021-09-01T21:53:05.707+02:00" "2021-09-01T21:53:39.141+02:00" ...</span>
<span class="co">##  $ locate_hamburg                                    : chr [1:8] "60.924739 -90.682977 0 0" "34.461879 -126.200905 0 0" "48.52047 70.320327 0 0" "64.520727 52.758186 0 0" ...</span>
<span class="co">##  $ _submission_time                                  : chr [1:8] "2021-09-01T19:38:34" "2021-09-01T19:52:25" "2021-09-01T19:53:05" "2021-09-01T19:53:39" ...</span>
<span class="co">##  $ _notes                                            :List of 8</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##   ..$ : list()</span>
<span class="co">##  $ _attachments                                      :List of 8</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 1 obs. of  9 variables:</span>
<span class="co">##   .. ..$ mimetype           : chr "image/png"</span>
<span class="co">##   .. ..$ download_small_url : chr "https://kc.correlaid.org/media/small?media_file=api_user%2Fattachments%2F1f37921296654b91b8cc11e152956764%2F40c"| __truncated__</span>
<span class="co">##   .. ..$ download_large_url : chr "https://kc.correlaid.org/media/large?media_file=api_user%2Fattachments%2F1f37921296654b91b8cc11e152956764%2F40c"| __truncated__</span>
<span class="co">##   .. ..$ download_url       : chr "https://kc.correlaid.org/media/original?media_file=api_user%2Fattachments%2F1f37921296654b91b8cc11e152956764%2F"| __truncated__</span>
<span class="co">##   .. ..$ filename           : chr "api_user/attachments/1f37921296654b91b8cc11e152956764/40c70c77-7d3d-4824-8e0e-43094764a75d/Screenshot 2021-09-0"| __truncated__</span>
<span class="co">##   .. ..$ instance           : int 532</span>
<span class="co">##   .. ..$ download_medium_url: chr "https://kc.correlaid.org/media/medium?media_file=api_user%2Fattachments%2F1f37921296654b91b8cc11e152956764%2F40"| __truncated__</span>
<span class="co">##   .. ..$ id                 : int 3</span>
<span class="co">##   .. ..$ xform              : int 18</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##   ..$ :'data.frame': 0 obs. of  0 variables</span>
<span class="co">##  $ importance_in_life/Leisure_time                   : chr [1:8] "1" "2" "2" "3" ...</span>
<span class="co">##  $ start                                             : chr [1:8] "2021-09-01T21:36:49.742+02:00" "2021-09-01T21:36:49.742+02:00" "2021-09-01T21:36:49.742+02:00" "2021-09-01T21:36:49.742+02:00" ...</span>
<span class="co">##  $ trust_in_groups/People_of_another_religion        : chr [1:8] "2" "3" "3" NA ...</span>
<span class="co">##  $ _geolocation                                      :List of 8</span>
<span class="co">##   ..$ : num [1:2] 60.9 -90.7</span>
<span class="co">##   ..$ : num [1:2] 34.5 -126.2</span>
<span class="co">##   ..$ : num [1:2] 48.5 70.3</span>
<span class="co">##   ..$ : num [1:2] 64.5 52.8</span>
<span class="co">##   ..$ : num [1:2] 62.3 43</span>
<span class="co">##   ..$ : num [1:2] 53.5 10</span>
<span class="co">##   ..$ : num [1:2] -6.5 85</span>
<span class="co">##   ..$ : num [1:2] 53.1 11.1</span>
<span class="co">##  $ importance_in_life/Work                           : chr [1:8] "1" "2" "1" "2" ...</span>
<span class="co">##  $ _status                                           : chr [1:8] "submitted_via_web" "submitted_via_web" "submitted_via_web" "submitted_via_web" ...</span>
<span class="co">##  $ __version__                                       : chr [1:8] "vkhZEtuEwyhNgJropgVs7h" "vkhZEtuEwyhNgJropgVs7h" "vkhZEtuEwyhNgJropgVs7h" "vkhZEtuEwyhNgJropgVs7h" ...</span>
<span class="co">##  $ trust_in_others                                   : chr [1:8] "2" "2" "2" "2" ...</span>
<span class="co">##  $ file_upload                                       : chr [1:8] NA NA NA NA ...</span></code></pre>
<p>Check out <a href="/articles/wrangling-survey-responses.html">Data wrangling of responses</a> to see how to handle messy column names.</p>
</div>
<div class="section level2">
<h2 id="kobo-administration-with-kbtbr">Kobo Administration with <code>kbtbr</code><a class="anchor" aria-label="anchor" href="#kobo-administration-with-kbtbr"></a>
</h2>
<p>With <code>kbtbr</code>, you can also manage your assets and do other useful administration tasks right from your R console.</p>
<div class="section level3">
<h3 id="create-an-asset">Create an Asset<a class="anchor" aria-label="anchor" href="#create-an-asset"></a>
</h3>
<p>You can also create assets using the <code>create_asset()</code> method of the Kobo class. This can be useful if you need to create a lot of assets at once.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">create_asset</span><span class="op">(</span><span class="st">"Question block"</span>, 
                  asset_type <span class="op">=</span> <span class="st">"block"</span>, 
                  description <span class="op">=</span> <span class="st">"this question block was created with the API."</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="fu">status_http</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;Status code: 201&gt;</span>
<span class="co">##   Message: Created</span>
<span class="co">##   Explanation: Document created, URL follows</span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response_content</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="fu">parse</span><span class="op">(</span><span class="st">"UTF-8"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">response_content</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 39</span>
<span class="co">##  $ url                            : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/"</span>
<span class="co">##  $ owner                          : chr "https://kobo.correlaid.org/api/v2/users/api_user/"</span>
<span class="co">##  $ owner__username                : chr "api_user"</span>
<span class="co">##  $ parent                         : NULL</span>
<span class="co">##  $ ancestors                      : NULL</span>
<span class="co">##  $ settings                       :List of 4</span>
<span class="co">##  $ asset_type                     : chr "block"</span>
<span class="co">##  $ date_created                   : chr "2022-01-24T13:24:29.331033Z"</span>
<span class="co">##  $ summary                        : Named list()</span>
<span class="co">##  $ date_modified                  : chr "2022-01-24T13:24:29.331054Z"</span>
<span class="co">##  $ version_id                     : chr "vZpxcU8qvJ9N6wHSiPsSpv"</span>
<span class="co">##  $ version__content_hash          : chr "4724ddb07034559d7fb5a3d18288dfb683a2d082"</span>
<span class="co">##  $ version_count                  : int 1</span>
<span class="co">##  $ has_deployment                 : logi FALSE</span>
<span class="co">##  $ deployed_version_id            : NULL</span>
<span class="co">##  $ deployed_versions              :List of 4</span>
<span class="co">##  $ deployment__identifier         : NULL</span>
<span class="co">##  $ deployment__links              : Named list()</span>
<span class="co">##  $ deployment__active             : logi FALSE</span>
<span class="co">##  $ deployment__data_download_links: Named list()</span>
<span class="co">##  $ deployment__submission_count   : int 0</span>
<span class="co">##  $ report_styles                  :List of 3</span>
<span class="co">##  $ report_custom                  : Named list()</span>
<span class="co">##  $ map_styles                     : Named list()</span>
<span class="co">##  $ map_custom                     : Named list()</span>
<span class="co">##  $ content                        :List of 3</span>
<span class="co">##  $ downloads                      :'data.frame': 2 obs. of  2 variables:</span>
<span class="co">##  $ embeds                         :'data.frame': 2 obs. of  2 variables:</span>
<span class="co">##  $ koboform_link                  : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/koboform/"</span>
<span class="co">##  $ xform_link                     : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/xform/"</span>
<span class="co">##  $ hooks_link                     : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/hooks/"</span>
<span class="co">##  $ tag_string                     : chr ""</span>
<span class="co">##  $ uid                            : chr "avJyi8RUCjQ4RSFA7qdWPG"</span>
<span class="co">##  $ kind                           : chr "asset"</span>
<span class="co">##  $ xls_link                       : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/xls/"</span>
<span class="co">##  $ name                           : chr "Question block"</span>
<span class="co">##  $ assignable_permissions         :'data.frame': 3 obs. of  2 variables:</span>
<span class="co">##  $ permissions                    :'data.frame': 3 obs. of  4 variables:</span>
<span class="co">##  $ data                           : chr "https://kobo.correlaid.org/api/v2/assets/avJyi8RUCjQ4RSFA7qdWPG/data/"</span></code></pre>
</div>
<div class="section level3">
<h3 id="cloning-an-asset">Cloning an Asset<a class="anchor" aria-label="anchor" href="#cloning-an-asset"></a>
</h3>
<p>In order to clone an asset, you just have to specify its ID, a new name for the cloned asset and its type.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">clone_asset</span><span class="op">(</span><span class="va">test_id</span>, <span class="st">"Test survey copy"</span>, <span class="st">"survey"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "HttpResponse" "R6"</span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="fu">status_http</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;Status code: 201&gt;</span>
<span class="co">##   Message: Created</span>
<span class="co">##   Explanation: Document created, URL follows</span></code></pre>
<p>Parse out the ID of the asset that was created:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response_content</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="fu">parse</span><span class="op">(</span><span class="st">"UTF-8"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">response_content</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 39</span>
<span class="co">##  $ url                            : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/"</span>
<span class="co">##  $ owner                          : chr "https://kobo.correlaid.org/api/v2/users/api_user/"</span>
<span class="co">##  $ owner__username                : chr "api_user"</span>
<span class="co">##  $ parent                         : NULL</span>
<span class="co">##  $ ancestors                      : NULL</span>
<span class="co">##  $ settings                       :List of 3</span>
<span class="co">##  $ asset_type                     : chr "survey"</span>
<span class="co">##  $ date_created                   : chr "2022-01-24T13:04:49.219153Z"</span>
<span class="co">##  $ summary                        :List of 6</span>
<span class="co">##  $ date_modified                  : chr "2022-01-24T13:04:49.219192Z"</span>
<span class="co">##  $ version_id                     : chr "vfAaB99KXQeGf2gMxWA57z"</span>
<span class="co">##  $ version__content_hash          : chr "f3e28cf31d58b03c955935dedec741d31d4537b8"</span>
<span class="co">##  $ version_count                  : int 1</span>
<span class="co">##  $ has_deployment                 : logi FALSE</span>
<span class="co">##  $ deployed_version_id            : NULL</span>
<span class="co">##  $ deployed_versions              :List of 4</span>
<span class="co">##  $ deployment__identifier         : NULL</span>
<span class="co">##  $ deployment__links              : Named list()</span>
<span class="co">##  $ deployment__active             : logi FALSE</span>
<span class="co">##  $ deployment__data_download_links: Named list()</span>
<span class="co">##  $ deployment__submission_count   : int 0</span>
<span class="co">##  $ report_styles                  :List of 3</span>
<span class="co">##  $ report_custom                  : Named list()</span>
<span class="co">##  $ map_styles                     : Named list()</span>
<span class="co">##  $ map_custom                     : Named list()</span>
<span class="co">##  $ content                        :List of 6</span>
<span class="co">##  $ downloads                      :'data.frame': 2 obs. of  2 variables:</span>
<span class="co">##  $ embeds                         :'data.frame': 2 obs. of  2 variables:</span>
<span class="co">##  $ koboform_link                  : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/koboform/"</span>
<span class="co">##  $ xform_link                     : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/xform/"</span>
<span class="co">##  $ hooks_link                     : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/hooks/"</span>
<span class="co">##  $ tag_string                     : chr ""</span>
<span class="co">##  $ uid                            : chr "ackE4RGzXMjWBei3bRHPbb"</span>
<span class="co">##  $ kind                           : chr "asset"</span>
<span class="co">##  $ xls_link                       : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/xls/"</span>
<span class="co">##  $ name                           : chr "Test survey copy"</span>
<span class="co">##  $ assignable_permissions         :'data.frame': 9 obs. of  2 variables:</span>
<span class="co">##  $ permissions                    :'data.frame': 8 obs. of  4 variables:</span>
<span class="co">##  $ data                           : chr "https://kobo.correlaid.org/api/v2/assets/ackE4RGzXMjWBei3bRHPbb/data/"</span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">test_clone_id</span> <span class="op">&lt;-</span> <span class="va">response_content</span><span class="op">$</span><span class="va">uid</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="deploying-an-asset">Deploying an asset<a class="anchor" aria-label="anchor" href="#deploying-an-asset"></a>
</h3>
<p>To deploy an existing asset, e.g. after cloning or updating:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">deploy_asset</span><span class="op">(</span><span class="va">test_clone_id</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "HttpResponse" "R6"</span></code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="fu">status_http</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;Status code: 200&gt;</span>
<span class="co">##   Message: OK</span>
<span class="co">##   Explanation: Request fulfilled, document follows</span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">response_content</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="fu">parse</span><span class="op">(</span><span class="st">"UTF-8"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">fromJSON</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">response_content</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## List of 5</span>
<span class="co">##  $ backend   : chr "kobocat"</span>
<span class="co">##  $ identifier: chr "https://kc.correlaid.org/api_user/forms/ackE4RGzXMjWBei3bRHPbb"</span>
<span class="co">##  $ active    : logi TRUE</span>
<span class="co">##  $ version_id: chr "vfAaB99KXQeGf2gMxWA57z"</span>
<span class="co">##  $ asset     :List of 37</span></code></pre>
</div>
<div class="section level3">
<h3 id="importing-xls-forms">Importing XLS forms<a class="anchor" aria-label="anchor" href="#importing-xls-forms"></a>
</h3>
<p>You can import an XLS form. This will create a draft survey/form which you could then again deploy using <code>kobo$deploy_asset()</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">kobo</span><span class="op">$</span><span class="fu">import_xls_form</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"XLS Form via import"</span>, <span class="st">"assets/xls_form_downloaded.xls"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="fu">status_http</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## &lt;Status code: 201&gt;</span>
<span class="co">##   Message: Created</span>
<span class="co">##   Explanation: Document created, URL follows</span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="making-it-your-own-post-and-get">Making it your own: <code>post</code> and <code>get</code><a class="anchor" aria-label="anchor" href="#making-it-your-own-post-and-get"></a>
</h2>
<p><code>kbtbr</code> is by no means complete. So you might find that some of your use cases are not covered by the existing methods of the <code>Kobo</code> class. For this purpose, <code>Kobo</code> as well as the lower-level <code>KoboClient</code> class expose generic <code>get</code> and <code>post</code> functions which should allow you to implement more functionalities on your own. You can check out the existing high-level functions (e.g. <code>get_assets</code> or <code>clone_asset</code>) to get ideas how your code should look like. Of course, contributions to <code>kbtbr</code> are always welcome.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dimitri Marinelli, Lada Rudnitckaia, Malte Kyhos, Timm Hamm, Frie Preu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
